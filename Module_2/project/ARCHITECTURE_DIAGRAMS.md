# ğŸ—ï¸ E-Commerce Product Onboarding System - Architecture Diagrams

## ğŸ“‹ Table of Contents

1. [High-Level Architecture](#1-high-level-architecture)
2. [Detailed Component Architecture](#2-detailed-component-architecture)
3. [Data Flow Architecture](#3-data-flow-architecture)
4. [Network Architecture](#4-network-architecture)
5. [Event-Driven Flow](#5-event-driven-flow)
6. [Database Architecture](#6-database-architecture)
7. [Error Handling Architecture](#7-error-handling-architecture)
8. [Security Architecture](#8-security-architecture)

---

## 1. High-Level Architecture

### System Overview
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PRODUCT ONBOARDING SYSTEM - HIGH LEVEL                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚   VENDOR     â”‚
                                 â”‚  (External)  â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚ Uploads CSV
                                        â†“
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚       AWS CLOUD (VPC)         â”‚
                        â”‚                               â”‚
                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                        â”‚  â”‚      S3 BUCKET          â”‚  â”‚
                        â”‚  â”‚  uploads/ | errors/     â”‚  â”‚
                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                        â”‚             â”‚                 â”‚
                        â”‚             â”‚ Triggers        â”‚
                        â”‚             â†“                 â”‚
                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                        â”‚  â”‚  LAMBDA FUNCTIONS (3)   â”‚  â”‚
                        â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
                        â”‚  â”‚  â”‚  CSV Parser     â”‚    â”‚  â”‚
                        â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
                        â”‚  â”‚           â”‚             â”‚  â”‚
                        â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
                        â”‚  â”‚  â”‚  Validator      â”‚    â”‚  â”‚
                        â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
                        â”‚  â”‚           â”‚             â”‚  â”‚
                        â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
                        â”‚  â”‚  â”‚ Error Processor â”‚    â”‚  â”‚
                        â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                        â”‚             â”‚                 â”‚
                        â”‚             â”‚ Stores Data     â”‚
                        â”‚             â†“                 â”‚
                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                        â”‚  â”‚     DATABASES           â”‚  â”‚
                        â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
                        â”‚  â”‚  â”‚ DynamoDB         â”‚   â”‚  â”‚
                        â”‚  â”‚  â”‚ (Temporary)      â”‚   â”‚  â”‚
                        â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
                        â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
                        â”‚  â”‚  â”‚ RDS PostgreSQL   â”‚   â”‚  â”‚
                        â”‚  â”‚  â”‚ (Permanent)      â”‚   â”‚  â”‚
                        â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                        â”‚             â”‚                 â”‚
                        â”‚             â”‚ Notifies        â”‚
                        â”‚             â†“                 â”‚
                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                        â”‚  â”‚   SNS â†’ EMAIL           â”‚  â”‚
                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                        â”‚                               â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚ Email
                                        â†“
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚    VENDOR    â”‚
                                 â”‚ (Receives    â”‚
                                 â”‚ Notification)â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Key Components
- **Entry Point**: S3 Bucket (CSV upload)
- **Processing**: 3 Lambda Functions (Serverless compute)
- **Storage**: DynamoDB (staging) + RDS (catalog)
- **Communication**: SQS (queuing) + SNS (notifications)
- **Security**: Secrets Manager, VPC, IAM

---

## 2. Detailed Component Architecture

### Complete System with All AWS Services
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DETAILED COMPONENT ARCHITECTURE                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚   VENDOR    â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â”‚ 1. Upload CSV
                                           â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                    AWS ACCOUNT                        â”‚
                    â”‚                                                       â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                    â”‚  â”‚            AMAZON S3 BUCKET                      â”‚ â”‚
                    â”‚  â”‚  ecommerce-product-uploads-{account-id}         â”‚ â”‚
                    â”‚  â”‚                                                  â”‚ â”‚
                    â”‚  â”‚  ğŸ“ uploads/                                     â”‚ â”‚
                    â”‚  â”‚     â””â”€ VEND001/                                  â”‚ â”‚
                    â”‚  â”‚        â””â”€ VEND001_20241221_103045.csv           â”‚ â”‚
                    â”‚  â”‚                                                  â”‚ â”‚
                    â”‚  â”‚  ğŸ“ errors/                                      â”‚ â”‚
                    â”‚  â”‚     â””â”€ VEND001/                                  â”‚ â”‚
                    â”‚  â”‚        â””â”€ UPLOAD_20241221_103045_errors.csv     â”‚ â”‚
                    â”‚  â”‚                                                  â”‚ â”‚
                    â”‚  â”‚  [Versioning: ON] [Encryption: AES-256]         â”‚ â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                    â”‚                     â”‚                                  â”‚
                    â”‚                     â”‚ 2. S3 Event Notification         â”‚
                    â”‚                     â”‚    (ObjectCreated:*)              â”‚
                    â”‚                     â†“                                  â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                    â”‚  â”‚         AWS LAMBDA: csv-parser                  â”‚ â”‚
                    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
                    â”‚  â”‚  â”‚  Container Image (from ECR)                â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚  â€¢ Python 3.11                             â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚  â€¢ boto3, psycopg2                         â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚  â€¢ Memory: 512 MB                          â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚  â€¢ Timeout: 5 min                          â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚                                            â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚  Process:                                  â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚  1. Download CSV from S3                  â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚  2. Verify vendor in RDS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚  3. Parse CSV rows                   â”‚    â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚  4. Batch insert to DynamoDB         â”‚    â”‚ â”‚ â”‚
                    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
                    â”‚  â”‚                       â”‚                           â”‚ â”‚
                    â”‚  â”‚  [VPC Enabled] [IAM Role: csv-parser-role]       â”‚ â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                    â”‚                          â”‚                              â”‚
                    â”‚                          â”‚ 3. Batch Write               â”‚
                    â”‚                          â†“                              â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                    â”‚  â”‚       AMAZON DYNAMODB: UploadRecords            â”‚ â”‚
                    â”‚  â”‚                                                  â”‚ â”‚
                    â”‚  â”‚  Table Schema:                                   â”‚ â”‚
                    â”‚  â”‚  â€¢ PK: upload_id (String)                       â”‚ â”‚
                    â”‚  â”‚  â€¢ SK: record_id (String)                       â”‚ â”‚
                    â”‚  â”‚  â€¢ Attributes: vendor_id, product_data, status  â”‚ â”‚
                    â”‚  â”‚                                                  â”‚ â”‚
                    â”‚  â”‚  Indexes:                                        â”‚ â”‚
                    â”‚  â”‚  â€¢ GSI: VendorIndex (vendor_id)                 â”‚ â”‚
                    â”‚  â”‚                                                  â”‚ â”‚
                    â”‚  â”‚  DynamoDB Streams: ENABLED (NEW_IMAGE)          â”‚ â”‚
                    â”‚  â”‚  Billing: On-Demand (Pay per request)           â”‚ â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                    â”‚                     â”‚                                  â”‚
                    â”‚                     â”‚ 4. Stream Trigger                â”‚
                    â”‚                     â”‚    (INSERT events)                â”‚
                    â”‚                     â†“                                  â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                    â”‚  â”‚      AWS LAMBDA: product-validator              â”‚ â”‚
                    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
                    â”‚  â”‚  â”‚  Container Image (from ECR)                â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚  â€¢ Python 3.11 + psycopg2                  â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚  â€¢ Memory: 512 MB                          â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚  â€¢ Timeout: 5 min                          â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚                                            â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚  Process:                                  â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚  1. Receive batch (100 records)           â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚  2. For each record:                      â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚     â€¢ Run 7 validation rules              â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚     â€¢ Query RDS for constraints â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚     â€¢ IF VALID: Insert to RDS  â”€â”€â”€â”€â”€â”€â”€â”¼â”€â” â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚     â€¢ IF INVALID: Send to SQS â”€â”€â”€â”€â”   â”‚ â”‚ â”‚ â”‚ â”‚
                    â”‚  â”‚  â”‚  3. Update DynamoDB status        â”‚   â”‚ â”‚ â”‚ â”‚ â”‚
                    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”˜ â”‚ â”‚
                    â”‚  â”‚                                      â”‚   â”‚       â”‚ â”‚
                    â”‚  â”‚  [VPC Enabled] [IAM Role: validator-role]â”‚       â”‚ â”‚
                    â”‚  â”‚  [Connection Pooling: Enabled]       â”‚   â”‚       â”‚ â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                    â”‚                                         â”‚   â”‚          â”‚
                    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚          â”‚
                    â”‚     â”‚                                       â”‚          â”‚
                    â”‚     â”‚ 5a. Valid Products                    â”‚ 5b. Errorsâ”‚
                    â”‚     â†“                                       â†“          â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                    â”‚  â”‚  RDS PostgreSQL      â”‚      â”‚   AMAZON SQS       â”‚ â”‚
                    â”‚  â”‚  ecommerce-db        â”‚      â”‚                    â”‚ â”‚
                    â”‚  â”‚                      â”‚      â”‚  Queue:            â”‚ â”‚
                    â”‚  â”‚  Tables:             â”‚      â”‚  product-          â”‚ â”‚
                    â”‚  â”‚  â€¢ products âœ“        â”‚      â”‚  validation-       â”‚ â”‚
                    â”‚  â”‚  â€¢ vendors           â”‚      â”‚  errors            â”‚ â”‚
                    â”‚  â”‚  â€¢ upload_history    â”‚      â”‚                    â”‚ â”‚
                    â”‚  â”‚  â€¢ product_categoriesâ”‚      â”‚  [Visibility: 5min]â”‚ â”‚
                    â”‚  â”‚  â€¢ validation_errors â”‚      â”‚  [Retention: 4 day]â”‚ â”‚
                    â”‚  â”‚                      â”‚      â”‚                    â”‚ â”‚
                    â”‚  â”‚  [VPC: Private]      â”‚      â”‚  DLQ: Enabled      â”‚ â”‚
                    â”‚  â”‚  [Encrypted: Yes]    â”‚      â”‚  [Max Receive: 3]  â”‚ â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                    â”‚            â–²                              â”‚             â”‚
                    â”‚            â”‚                              â”‚             â”‚
                    â”‚            â”‚                              â”‚ 6. Batch    â”‚
                    â”‚            â”‚                              â”‚    Trigger  â”‚
                    â”‚            â”‚                              â”‚    (10 msg, â”‚
                    â”‚            â”‚                              â”‚     30 sec) â”‚
                    â”‚            â”‚                              â†“             â”‚
                    â”‚            â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚            â”‚          â”‚  AWS LAMBDA:                â”‚  â”‚
                    â”‚            â”‚          â”‚  error-processor            â”‚  â”‚
                    â”‚            â”‚          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
                    â”‚            â”‚          â”‚  â”‚ Container (from ECR)   â”‚ â”‚  â”‚
                    â”‚            â”‚          â”‚  â”‚ â€¢ Python 3.11          â”‚ â”‚  â”‚
                    â”‚            â”‚          â”‚  â”‚ â€¢ Memory: 256 MB       â”‚ â”‚  â”‚
                    â”‚            â”‚          â”‚  â”‚                        â”‚ â”‚  â”‚
                    â”‚            â”‚          â”‚  â”‚ Process:               â”‚ â”‚  â”‚
                    â”‚            â”‚          â”‚  â”‚ 1. Parse SQS messages  â”‚ â”‚  â”‚
                    â”‚            â”‚          â”‚  â”‚ 2. Group by upload_id  â”‚ â”‚  â”‚
                    â”‚            â”‚          â”‚  â”‚ 3. Generate error CSV  â”‚ â”‚  â”‚
                    â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”‚ 4. Upload to S3  â”€â”€â”€â”€â”€â”€â”¼â”€â”¼â”€â”€â”˜
                    â”‚     Read credentials  â”‚  â”‚ 5. Update RDS          â”‚ â”‚
                    â”‚                       â”‚  â”‚ 6. Check completion    â”‚ â”‚
                    â”‚                       â”‚  â”‚ 7. Trigger SNS â”€â”€â”€â”€â”   â”‚ â”‚
                    â”‚                       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”˜ â”‚
                    â”‚                       â”‚                       â”‚     â”‚
                    â”‚                       â”‚  [VPC Enabled]        â”‚     â”‚
                    â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”˜
                    â”‚                                               â”‚
                    â”‚                                               â”‚ 7. Publish
                    â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚       â”‚
                    â”‚       â†“
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  â”‚          AMAZON SNS TOPIC                        â”‚
                    â”‚  â”‚  product-upload-notifications                    â”‚
                    â”‚  â”‚                                                   â”‚
                    â”‚  â”‚  Subscriptions:                                  â”‚
                    â”‚  â”‚  â€¢ Email: vendor@example.com âœ“ (Confirmed)      â”‚
                    â”‚  â”‚  â€¢ Email: support@company.com âœ“ (Confirmed)     â”‚
                    â”‚  â”‚                                                   â”‚
                    â”‚  â”‚  Message Format:                                 â”‚
                    â”‚  â”‚  â€¢ Subject: Upload Complete (93.5% Success)      â”‚
                    â”‚  â”‚  â€¢ Body: Statistics + Error CSV link             â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                     â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  â”‚         SUPPORTING SERVICES                       â”‚
                    â”‚  â”‚                                                   â”‚
                    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚  â”‚  AWS SECRETS MANAGER                       â”‚  â”‚
                    â”‚  â”‚  â”‚  ecommerce/rds/credentials                 â”‚  â”‚
                    â”‚  â”‚  â”‚  â€¢ username, password, host, port, dbname  â”‚  â”‚
                    â”‚  â”‚  â”‚  â€¢ KMS Encrypted                           â”‚  â”‚
                    â”‚  â”‚  â”‚  â€¢ Client-side caching (1 hour)            â”‚  â”‚
                    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â”‚  â”‚                                                   â”‚
                    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚  â”‚  AMAZON ECR (Container Registry)           â”‚  â”‚
                    â”‚  â”‚  â”‚  â€¢ csv-parser-lambda:latest                â”‚  â”‚
                    â”‚  â”‚  â”‚  â€¢ product-validator-lambda:latest         â”‚  â”‚
                    â”‚  â”‚  â”‚  â€¢ error-processor-lambda:latest           â”‚  â”‚
                    â”‚  â”‚  â”‚  [Image Scanning: Enabled]                 â”‚  â”‚
                    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â”‚  â”‚                                                   â”‚
                    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚  â”‚  AMAZON CLOUDWATCH                         â”‚  â”‚
                    â”‚  â”‚  â”‚  â€¢ Log Groups: /aws/lambda/{function}      â”‚  â”‚
                    â”‚  â”‚  â”‚  â€¢ Metrics: Custom + Lambda metrics        â”‚  â”‚
                    â”‚  â”‚  â”‚  â€¢ Alarms: Error rate, Duration            â”‚  â”‚
                    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â”‚  â”‚                                                   â”‚
                    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚  â”‚  AWS IAM (Identity & Access Management)    â”‚  â”‚
                    â”‚  â”‚  â”‚  â€¢ Lambda execution roles (3)              â”‚  â”‚
                    â”‚  â”‚  â”‚  â€¢ Service policies (least privilege)      â”‚  â”‚
                    â”‚  â”‚  â”‚  â€¢ Resource-based policies                 â”‚  â”‚
                    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚ 8. Email
                                          â†“
                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                   â”‚    VENDOR    â”‚
                                   â”‚  (Receives)  â”‚
                                   â”‚              â”‚
                                   â”‚  ğŸ“§ Email:   â”‚
                                   â”‚  â€¢ Stats     â”‚
                                   â”‚  â€¢ Download  â”‚
                                   â”‚    link      â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Data Flow Architecture

### Step-by-Step Data Journey
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DATA FLOW ARCHITECTURE                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STEP 1: CSV UPLOAD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    Vendor's Computer
                          â”‚
                          â”‚ [HTTP PUT]
                          â”‚ VEND001_products.csv (5 MB, 1000 rows)
                          â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   S3 Bucket â”‚
                    â”‚             â”‚
                    â”‚  Object:    â”‚
                    â”‚  Key: uploads/VEND001/VEND001_products.csv              â”‚
                    â”‚  Size: 5 MB                                              â”‚
                    â”‚  ETag: d41d8cd98f00b204e9800998ecf8427e                 â”‚
                    â”‚  Storage Class: STANDARD                                 â”‚
                    â”‚  Encryption: AES-256                                     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ [S3 Event: ObjectCreated:Put]
                          â”‚
                          â†“

STEP 2: CSV PARSING (Lambda: csv-parser)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  CSV Parser Lambda Execution         â”‚
                    â”‚                                      â”‚
                    â”‚  T+0ms:   Lambda invoked            â”‚
                    â”‚  T+10ms:  Download CSV from S3      â”‚
                    â”‚           â”œâ”€ GetObject API call      â”‚
                    â”‚           â””â”€ StreamingBody (5 MB)   â”‚
                    â”‚                                      â”‚
                    â”‚  T+500ms: Query RDS                  â”‚
                    â”‚           SELECT * FROM vendors      â”‚
                    â”‚           WHERE vendor_id='VEND001'  â”‚
                    â”‚           Result: âœ“ Active vendor    â”‚
                    â”‚                                      â”‚
                    â”‚  T+600ms: Insert upload_history      â”‚
                    â”‚           INSERT INTO upload_history â”‚
                    â”‚           (upload_id, vendor_id,     â”‚
                    â”‚            file_name, total_records) â”‚
                    â”‚           VALUES ('UPLOAD_001',      â”‚
                    â”‚                   'VEND001',         â”‚
                    â”‚                   'VEND...csv', 1000)â”‚
                    â”‚                                      â”‚
                    â”‚  T+700ms: Parse CSV                  â”‚
                    â”‚           DictReader processes rows  â”‚
                    â”‚           Row 1 â†’ Dict               â”‚
                    â”‚           Row 2 â†’ Dict               â”‚
                    â”‚           ... (1000 rows)            â”‚
                    â”‚                                      â”‚
                    â”‚  T+2000ms: Batch insert DynamoDB     â”‚
                    â”‚            Batch 1: Rows 1-25        â”‚
                    â”‚            Batch 2: Rows 26-50       â”‚
                    â”‚            ... (40 batches total)    â”‚
                    â”‚                                      â”‚
                    â”‚  T+2500ms: Complete âœ“                â”‚
                    â”‚            Duration: 2.5 seconds     â”‚
                    â”‚            Memory: 256 MB used       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ [1000 DynamoDB items inserted]
                          â†“

STEP 3: DYNAMODB STORAGE (Temporary Staging)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      DynamoDB: UploadRecords         â”‚
                    â”‚                                      â”‚
                    â”‚  Item 1:                             â”‚
                    â”‚  {                                   â”‚
                    â”‚    upload_id: "UPLOAD_001",         â”‚
                    â”‚    record_id: "REC_00001",          â”‚
                    â”‚    vendor_id: "VEND001",            â”‚
                    â”‚    row_number: 1,                   â”‚
                    â”‚    status: "pending_validation",    â”‚
                    â”‚    product_data: {                  â”‚
                    â”‚      vendor_product_id: "PROD001",  â”‚
                    â”‚      product_name: "Wireless Mouse",â”‚
                    â”‚      sku: "SKU-001",                â”‚
                    â”‚      price: 19.99,                  â”‚
                    â”‚      stock_quantity: 150            â”‚
                    â”‚    }                                 â”‚
                    â”‚  }                                   â”‚
                    â”‚                                      â”‚
                    â”‚  ... (1000 items)                    â”‚
                    â”‚                                      â”‚
                    â”‚  DynamoDB Streams:                   â”‚
                    â”‚  â”œâ”€ 1000 INSERT events captured      â”‚
                    â”‚  â”œâ”€ StreamViewType: NEW_IMAGE        â”‚
                    â”‚  â””â”€ Batched for Lambda trigger       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ [Stream Event: 1000 records, batched to 10]
                          â†“

STEP 4: VALIDATION (Lambda: product-validator) - 10 Invocations
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Validator Lambda - Batch 1 (100 records) â”‚
                    â”‚                                      â”‚
                    â”‚  For Record 1 (Row 1):               â”‚
                    â”‚                                      â”‚
                    â”‚  âœ“ Required fields present           â”‚
                    â”‚  âœ“ Price: 19.99 (valid range)        â”‚
                    â”‚  âœ“ Stock: 150 (valid range)          â”‚
                    â”‚  âœ“ Field lengths OK                  â”‚
                    â”‚  âœ“ Category: "Electronics" (exists)  â”‚
                    â”‚    â”œâ”€ SELECT FROM product_categories â”‚
                    â”‚    â””â”€ Result: âœ“ Found                â”‚
                    â”‚  âœ“ SKU unique: "SKU-001"             â”‚
                    â”‚    â”œâ”€ SELECT FROM products           â”‚
                    â”‚    â”‚   WHERE sku='SKU-001'            â”‚
                    â”‚    â””â”€ Result: 0 rows (unique!)       â”‚
                    â”‚  âœ“ Vendor product ID unique          â”‚
                    â”‚    â”œâ”€ SELECT FROM products           â”‚
                    â”‚    â”‚   WHERE vendor_id='VEND001'      â”‚
                    â”‚    â”‚   AND vendor_product_id='PROD001'â”‚
                    â”‚    â””â”€ Result: 0 rows (unique!)       â”‚
                    â”‚                                      â”‚
                    â”‚  RESULT: VALID âœ“                     â”‚
                    â”‚                                      â”‚
                    â”‚  Action:                             â”‚
                    â”‚  1. INSERT INTO products             â”‚
                    â”‚     (vendor_id, vendor_product_id,   â”‚
                    â”‚      product_name, sku, price, ...)  â”‚
                    â”‚     RETURNING product_id;            â”‚
                    â”‚     Result: product_id = 12345       â”‚
                    â”‚                                      â”‚
                    â”‚  2. UPDATE DynamoDB                  â”‚
                    â”‚     SET status='validated',          â”‚
                    â”‚         processed_at=NOW()           â”‚
                    â”‚     WHERE upload_id='UPLOAD_001'     â”‚
                    â”‚     AND record_id='REC_00001'        â”‚
                    â”‚                                      â”‚
                    â”‚  For Record 15 (Row 15):             â”‚
                    â”‚                                      â”‚
                    â”‚  âœ— Price: -10.00 (INVALID!)          â”‚
                    â”‚                                      â”‚
                    â”‚  RESULT: INVALID âœ—                   â”‚
                    â”‚  Error Type: INVALID_PRICE           â”‚
                    â”‚  Error Message: "Price must be >= 0.01"â”‚
                    â”‚                                      â”‚
                    â”‚  Action:                             â”‚
                    â”‚  1. SEND to SQS error queue          â”‚
                    â”‚     Message: {upload_id, record_id,  â”‚
                    â”‚              error_type, message}    â”‚
                    â”‚                                      â”‚
                    â”‚  2. INSERT INTO validation_errors    â”‚
                    â”‚     (upload_id, row_number,          â”‚
                    â”‚      error_type, error_message, ...) â”‚
                    â”‚                                      â”‚
                    â”‚  3. UPDATE DynamoDB                  â”‚
                    â”‚     SET status='error',              â”‚
                    â”‚         error_reason='INVALID_PRICE',â”‚
                    â”‚         error_details='Price...'     â”‚
                    â”‚                                      â”‚
                    â”‚  ... (Processes all 100 in batch)    â”‚
                    â”‚                                      â”‚
                    â”‚  Batch Summary:                      â”‚
                    â”‚  â€¢ Total: 100                        â”‚
                    â”‚  â€¢ Valid: 95                         â”‚
                    â”‚  â€¢ Invalid: 5                        â”‚
                    â”‚  â€¢ Duration: 4.5 seconds             â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ [After 10 batches: 950 valid, 50 errors]
                          â”‚
                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚                â”‚                  â”‚
                          â†“                â†“                  â†“
                    RDS Products    SQS Queue         DynamoDB Updated
                    (950 inserts)   (50 messages)     (1000 status updated)

STEP 5: ERROR AGGREGATION (SQS Wait Period)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚        SQS Error Queue               â”‚
                    â”‚                                      â”‚
                    â”‚  T+0s:  Message 1 arrives (Error 1)  â”‚
                    â”‚  T+0.5s: Message 2 arrives (Error 2) â”‚
                    â”‚  ...                                 â”‚
                    â”‚  T+4s:  Message 50 arrives (Error 50)â”‚
                    â”‚                                      â”‚
                    â”‚  T+30s: Batching window expires      â”‚
                    â”‚         (No new messages for 30s)    â”‚
                    â”‚                                      â”‚
                    â”‚  Trigger Lambda with:                â”‚
                    â”‚  â€¢ Batch size: 10 messages           â”‚
                    â”‚  â€¢ 5 invocations total (50Ã·10)       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ [Batch trigger: 10 messages Ã— 5 invocations]
                          â†“

STEP 6: ERROR PROCESSING (Lambda: error-processor)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Error Processor Lambda              â”‚
                    â”‚                                      â”‚
                    â”‚  T+0ms:   Receive 10 SQS messages    â”‚
                    â”‚                                      â”‚
                    â”‚  T+10ms:  Parse messages             â”‚
                    â”‚           Group by upload_id         â”‚
                    â”‚           {                          â”‚
                    â”‚             'UPLOAD_001': [          â”‚
                    â”‚               {row: 15, error: ...}, â”‚
                    â”‚               {row: 27, error: ...}, â”‚
                    â”‚               ... (10 errors)        â”‚
                    â”‚             ]                        â”‚
                    â”‚           }                          â”‚
                    â”‚                                      â”‚
                    â”‚  T+50ms:  Generate CSV               â”‚
                    â”‚           Row,SKU,Error Type,Message â”‚
                    â”‚           15,SKU-015,INVALID_PRICE,...â”‚
                    â”‚           27,SKU-027,DUPLICATE_SKU,...â”‚
                    â”‚           ... (10 rows)              â”‚
                    â”‚                                      â”‚
                    â”‚  T+200ms: Upload to S3               â”‚
                    â”‚           PutObject:                 â”‚
                    â”‚           errors/VEND001/            â”‚
                    â”‚           UPLOAD_001_errors.csv      â”‚
                    â”‚                                      â”‚
                    â”‚  T+250ms: Generate presigned URL     â”‚
                    â”‚           Expires in: 7 days         â”‚
                    â”‚           URL: https://s3.../errors/...â”‚
                    â”‚                                      â”‚
                    â”‚  T+300ms: Update RDS upload_history  â”‚
                    â”‚           UPDATE upload_history      â”‚
                    â”‚           SET error_file_s3_key=     â”‚
                    â”‚               'errors/VEND001/...'   â”‚
                    â”‚           WHERE upload_id='UPLOAD_001'â”‚
                    â”‚                                      â”‚
                    â”‚  T+350ms: Check completion           â”‚
                    â”‚           SELECT total_records,      â”‚
                    â”‚                  valid_records,      â”‚
                    â”‚                  error_records       â”‚
                    â”‚           FROM upload_history        â”‚
                    â”‚           WHERE upload_id='UPLOAD_001'â”‚
                    â”‚           Result: 1000, 950, 50      â”‚
                    â”‚           Is Complete? 950+50=1000 âœ“ â”‚
                    â”‚                                      â”‚
                    â”‚  T+400ms: Trigger SNS                â”‚
                    â”‚           Publish message            â”‚
                    â”‚           Topic: product-upload-...  â”‚
                    â”‚           Subject: Upload Complete   â”‚
                    â”‚           Body: Stats + download linkâ”‚
                    â”‚                                      â”‚
                    â”‚  T+500ms: Complete âœ“                 â”‚
                    â”‚           Duration: 0.5 seconds      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ [SNS Publish]
                          â†“

STEP 7: NOTIFICATION (SNS â†’ Email)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚          SNS Topic                   â”‚
                    â”‚  product-upload-notifications        â”‚
                    â”‚                                      â”‚
                    â”‚  Message:                            â”‚
                    â”‚  Subject: Upload Complete (95%)      â”‚
                    â”‚  Body:                               â”‚
                    â”‚    Upload ID: UPLOAD_001             â”‚
                    â”‚    File: VEND001_products.csv        â”‚
                    â”‚    Total: 1000                       â”‚
                    â”‚    Valid: 950 (95%)                  â”‚
                    â”‚    Invalid: 50 (5%)                  â”‚
                    â”‚    Status: PARTIAL                   â”‚
                    â”‚    Download Errors: [presigned URL]  â”‚
                    â”‚                                      â”‚
                    â”‚  Subscribers:                        â”‚
                    â”‚  â€¢ vendor@example.com â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â€¢ support@company.com            â”‚  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”˜
                                                        â”‚
                                                        â”‚ [SES Email Delivery]
                                                        â†“
                                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                 â”‚    VENDOR    â”‚
                                                 â”‚    INBOX     â”‚
                                                 â”‚              â”‚
                                                 â”‚  ğŸ“§ New Emailâ”‚
                                                 â”‚  From: AWS   â”‚
                                                 â”‚  Subject:    â”‚
                                                 â”‚  Upload...   â”‚
                                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FINAL STATE - All Data Locations
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

S3 Bucket:
â”œâ”€ uploads/VEND001/VEND001_products.csv (original)
â””â”€ errors/VEND001/UPLOAD_001_errors.csv (error report)

DynamoDB UploadRecords:
â”œâ”€ 950 records: status='validated'
â””â”€ 50 records: status='error'

RDS PostgreSQL:
â”œâ”€ products: 950 new rows (validated catalog)
â”œâ”€ upload_history: 1 row (total=1000, valid=950, error=50, status='partial')
â””â”€ validation_errors: 50 rows (detailed error tracking)

SQS Queue:
â””â”€ 0 messages (all processed and deleted)

Email:
â””â”€ Delivered to vendor âœ“
```

---

## 4. Network Architecture

### VPC and Security Architecture
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           NETWORK ARCHITECTURE                                  â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        AWS REGION: us-east-1                               â”‚ â”‚
â”‚  â”‚                                                                            â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚                    VPC: 10.0.0.0/16                                   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                                       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚              AVAILABILITY ZONE: us-east-1a                       â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚                                                                  â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  PUBLIC SUBNET: 10.0.1.0/24                                â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                                             â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  NAT GATEWAY     â”‚                                      â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  (For Lambda â†’   â”‚                                      â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚   Internet)      â”‚                                      â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚           â”‚                                                â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚              â”‚                                                  â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  PRIVATE SUBNET 1: 10.0.10.0/24                            â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                                             â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  LAMBDA FUNCTIONS (3)                               â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                                                      â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  CSV Parser    â”‚  â”‚  Validator     â”‚            â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                â”‚  â”‚                â”‚            â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  ENI:          â”‚  â”‚  ENI:          â”‚            â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  10.0.10.5     â”‚  â”‚  10.0.10.6     â”‚            â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                â”‚  â”‚                â”‚            â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  SG:           â”‚  â”‚  SG:           â”‚            â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  lambda-sg     â”‚  â”‚  lambda-sg     â”‚            â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚          â”‚                   â”‚                     â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚                     â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Error Processorâ”‚         â”‚                     â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                â”‚          â”‚                     â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  ENI:          â”‚          â”‚                     â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  10.0.10.7     â”‚          â”‚                     â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                â”‚          â”‚                     â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  SG: lambda-sg â”‚          â”‚                     â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚                     â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                              â”‚                     â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                 â”‚                        â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                 â”‚ TCP 5432               â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                 â†“ (PostgreSQL)           â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  RDS PostgreSQL                                     â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                                                      â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Endpoint: ecommerce-db.xxxxx.rds.amazonaws.com    â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Private IP: 10.0.10.100                           â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                                                      â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Security Group: rds-sg                            â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Inbound Rules:                                     â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ Port 5432 from lambda-sg âœ“                      â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ Deny all other                                   â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                                                      â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  [NOT publicly accessible]                          â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                                             â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚                                                                  â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                                       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚              AVAILABILITY ZONE: us-east-1b                       â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚                                                                  â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  PRIVATE SUBNET 2: 10.0.20.0/24                            â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                                             â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  RDS PostgreSQL (Standby Replica)                   â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Private IP: 10.0.20.100                            â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  [Multi-AZ for High Availability]                   â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                                       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚              INTERNET GATEWAY                                    â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  (For NAT Gateway connectivity)                                 â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                                       â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                            â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚              VPC ENDPOINTS (AWS PrivateLink)                          â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                                       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ S3 Endpoint (Gateway)      â†’ Access S3 without internet          â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ DynamoDB Endpoint (Gateway) â†’ Access DynamoDB without internet    â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Secrets Manager Endpoint   â†’ Access Secrets without internet     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ ECR Endpoint               â†’ Pull images without internet        â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              AWS SERVICES (Outside VPC)                                   â”‚ â”‚
â”‚  â”‚                                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚  â”‚  â”‚    SQS     â”‚  â”‚    SNS     â”‚  â”‚  DynamoDB  â”‚  â”‚     S3     â”‚        â”‚ â”‚
â”‚  â”‚  â”‚            â”‚  â”‚            â”‚  â”‚            â”‚  â”‚            â”‚        â”‚ â”‚
â”‚  â”‚  â”‚  Accessed  â”‚  â”‚  Accessed  â”‚  â”‚  Accessed  â”‚  â”‚  Accessed  â”‚        â”‚ â”‚
â”‚  â”‚  â”‚  via NAT   â”‚  â”‚  via NAT   â”‚  â”‚  via VPC   â”‚  â”‚  via VPC   â”‚        â”‚ â”‚
â”‚  â”‚  â”‚  Gateway   â”‚  â”‚  Gateway   â”‚  â”‚  Endpoint  â”‚  â”‚  Endpoint  â”‚        â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SECURITY GROUPS CONFIGURATION:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Security Group: lambda-sg                                               â”‚
â”‚  Purpose: Lambda functions                                              â”‚
â”‚                                                                          â”‚
â”‚  Outbound Rules:                                                         â”‚
â”‚  â€¢ TCP 5432 â†’ rds-sg (PostgreSQL)                    âœ“                 â”‚
â”‚  â€¢ TCP 443 â†’ 0.0.0.0/0 (HTTPS for AWS APIs)          âœ“                 â”‚
â”‚  â€¢ All traffic â†’ VPC Endpoints                        âœ“                 â”‚
â”‚                                                                          â”‚
â”‚  Inbound Rules:                                                          â”‚
â”‚  â€¢ NONE (Lambda doesn't need inbound)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Security Group: rds-sg                                                  â”‚
â”‚  Purpose: RDS PostgreSQL                                                â”‚
â”‚                                                                          â”‚
â”‚  Inbound Rules:                                                          â”‚
â”‚  â€¢ TCP 5432 from lambda-sg                            âœ“                 â”‚
â”‚  â€¢ Deny all other sources                             âœ“                 â”‚
â”‚                                                                          â”‚
â”‚  Outbound Rules:                                                         â”‚
â”‚  â€¢ All traffic (for replication to standby)           âœ“                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

NETWORK TRAFFIC FLOWS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Flow 1: Lambda â†’ S3
  Lambda (10.0.10.5) â†’ VPC S3 Endpoint â†’ S3 Bucket
  [Private connection, no internet]

Flow 2: Lambda â†’ DynamoDB
  Lambda (10.0.10.5) â†’ VPC DynamoDB Endpoint â†’ DynamoDB
  [Private connection, no internet]

Flow 3: Lambda â†’ RDS
  Lambda (10.0.10.5) â†’ RDS (10.0.10.100)
  [Direct VPC connection, security group enforced]

Flow 4: Lambda â†’ Secrets Manager
  Lambda (10.0.10.5) â†’ VPC Secrets Manager Endpoint â†’ Secrets Manager
  [Private connection, no internet]

Flow 5: Lambda â†’ SQS/SNS
  Lambda (10.0.10.5) â†’ NAT Gateway (10.0.1.x) â†’ Internet Gateway â†’ SQS/SNS
  [Goes through NAT for internet access]

Flow 6: ECR Image Pull (Cold Start)
  Lambda â†’ VPC ECR Endpoint â†’ ECR
  [Private connection for pulling container images]
```

---

## 5. Event-Driven Flow

### Event Propagation Timeline
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        EVENT-DRIVEN FLOW TIMELINE                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

TIME: T+0 seconds
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    VENDOR    â”‚
                    â”‚  Uploads CSV â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”‚ HTTP PUT Request
                           â”‚ Authorization: AWS4-HMAC-SHA256...
                           â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   S3 BUCKET  â”‚ â† Event: ObjectCreated:Put
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”‚ Generates S3 Event
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  S3 Event Notification                       â”‚
                    â”‚  {                                            â”‚
                    â”‚    "Records": [{                             â”‚
                    â”‚      "eventName": "ObjectCreated:Put",       â”‚
                    â”‚      "s3": {                                 â”‚
                    â”‚        "bucket": {"name": "..."},            â”‚
                    â”‚        "object": {"key": "uploads/...csv"}   â”‚
                    â”‚      }                                        â”‚
                    â”‚    }]                                         â”‚
                    â”‚  }                                            â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”‚ Lambda Service receives event
                           â”‚
TIME: T+0.1 seconds        â†“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  LAMBDA: csv-parser              â”‚
                    â”‚  Status: Invoked                 â”‚
                    â”‚                                  â”‚
                    â”‚  Cold Start:                     â”‚
                    â”‚  â€¢ Allocate execution environmentâ”‚
                    â”‚  â€¢ Pull container from ECR       â”‚
                    â”‚  â€¢ Initialize runtime            â”‚
                    â”‚  â€¢ Import modules                â”‚
                    â”‚                                  â”‚
                    â”‚  Duration: ~3 seconds            â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

TIME: T+3 seconds (Warm Lambda)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  LAMBDA: csv-parser              â”‚
                    â”‚  Status: Processing              â”‚
                    â”‚                                  â”‚
                    â”‚  Actions:                        â”‚
                    â”‚  1. Download CSV from S3         â”‚
                    â”‚  2. Parse 1000 rows              â”‚
                    â”‚  3. Batch insert DynamoDB        â”‚
                    â”‚                                  â”‚
                    â”‚  Duration: ~2.5 seconds          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ BatchWriteItem (1000 items)
                             â†“
TIME: T+5.5 seconds
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  DYNAMODB: UploadRecords         â”‚ â† Event: 1000 INSERTs
                    â”‚  1000 items inserted             â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ DynamoDB Streams capture changes
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  DynamoDB Stream Records (1000)          â”‚
                    â”‚                                           â”‚
                    â”‚  Shard 1: Records 1-400   â†’ Batch 1-4    â”‚
                    â”‚  Shard 2: Records 401-700 â†’ Batch 5-7    â”‚
                    â”‚  Shard 3: Records 701-1000 â†’ Batch 8-10  â”‚
                    â”‚                                           â”‚
                    â”‚  Event Source Mapping batches records    â”‚
                    â”‚  (100 per batch = 10 batches total)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Parallel Lambda invocations
                             â†“
TIME: T+5.6 seconds
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  LAMBDA: product-validator             â”‚
                    â”‚  10 concurrent executions              â”‚
                    â”‚                                        â”‚
                    â”‚  Execution 1: Records 1-100            â”‚
                    â”‚  Execution 2: Records 101-200          â”‚
                    â”‚  ...                                   â”‚
                    â”‚  Execution 10: Records 901-1000        â”‚
                    â”‚                                        â”‚
                    â”‚  Each execution:                       â”‚
                    â”‚  â€¢ Validates 100 records               â”‚
                    â”‚  â€¢ Inserts valid â†’ RDS                 â”‚
                    â”‚  â€¢ Sends invalid â†’ SQS                 â”‚
                    â”‚  â€¢ Duration: ~4.5 seconds each         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Results:
                             â”‚ â€¢ 950 valid â†’ RDS
                             â”‚ â€¢ 50 errors â†’ SQS
                             â†“
TIME: T+10 seconds
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  SQS: product-validation-errors  â”‚ â† Event: 50 messages
                    â”‚  50 error messages queued        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Wait for batching window
                             â”‚ (30 seconds max)
                             â†“
TIME: T+40 seconds (30s timeout)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  SQS Event Source Mapping        â”‚
                    â”‚                                  â”‚
                    â”‚  Batching:                       â”‚
                    â”‚  â€¢ Batch size: 10 messages       â”‚
                    â”‚  â€¢ Total messages: 50            â”‚
                    â”‚  â€¢ Lambda invocations: 5         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Invoke Lambda 5 times
                             â†“
TIME: T+40.1 seconds
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  LAMBDA: error-processor               â”‚
                    â”‚  5 concurrent executions               â”‚
                    â”‚                                        â”‚
                    â”‚  Execution 1: Messages 1-10            â”‚
                    â”‚  Execution 2: Messages 11-20           â”‚
                    â”‚  ...                                   â”‚
                    â”‚  Execution 5: Messages 41-50           â”‚
                    â”‚                                        â”‚
                    â”‚  Each execution:                       â”‚
                    â”‚  â€¢ Groups errors by upload_id          â”‚
                    â”‚  â€¢ Generates CSV chunk                 â”‚
                    â”‚  â€¢ Duration: ~0.5 seconds each         â”‚
                    â”‚                                        â”‚
                    â”‚  Final execution (when complete):      â”‚
                    â”‚  â€¢ Uploads error CSV to S3             â”‚
                    â”‚  â€¢ Triggers SNS                        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Publish to SNS
                             â†“
TIME: T+41 seconds
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  SNS: Upload notifications       â”‚ â† Event: Message published
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Deliver to subscriptions
                             â†“
TIME: T+42 seconds
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ EMAIL (SES)  â”‚
                    â”‚ Sent to:     â”‚
                    â”‚ â€¢ vendor@... â”‚
                    â”‚ â€¢ support@...â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    VENDOR    â”‚
                    â”‚  Receives    â”‚
                    â”‚  Notificationâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TOTAL ELAPSED TIME: ~42 seconds
FROM: CSV upload
TO: Vendor receives email notification

BREAKDOWN:
â€¢ T+0 to T+5.5s:  CSV parsing (5.5s)
â€¢ T+5.5 to T+10s: Validation (4.5s parallel)
â€¢ T+10 to T+40s:  SQS batching wait (30s)
â€¢ T+40 to T+42s:  Error processing + email (2s)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 6. Database Architecture

### RDS PostgreSQL & DynamoDB Schema
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DATABASE ARCHITECTURE                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RDS POSTGRESQL - PERMANENT CATALOG                                           â”‚
â”‚  ecommerce_platform database                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  TABLE: vendors                                                     â”‚
  â”‚  Purpose: Master vendor registry                                   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  vendor_id VARCHAR(50) PRIMARY KEY                                 â”‚
  â”‚  vendor_name VARCHAR(200) NOT NULL                                 â”‚
  â”‚  email VARCHAR(255) NOT NULL                                       â”‚
  â”‚  phone VARCHAR(20)                                                 â”‚
  â”‚  status VARCHAR(20) DEFAULT 'active'                               â”‚
  â”‚  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP                    â”‚
  â”‚                                                                     â”‚
  â”‚  Sample Data:                                                       â”‚
  â”‚  VEND001 | TechGear      | contact@techgear.com | active           â”‚
  â”‚  VEND002 | StyleWear     | sales@stylewear.com  | active           â”‚
  â”‚  VEND003 | HomeEssentials| info@homeess.com     | active           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ Referenced by
                 â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  TABLE: products                                                    â”‚
  â”‚  Purpose: Validated product catalog                                â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  product_id SERIAL PRIMARY KEY                                     â”‚
  â”‚  vendor_id VARCHAR(50) REFERENCES vendors(vendor_id)               â”‚
  â”‚  vendor_product_id VARCHAR(100) NOT NULL                           â”‚
  â”‚  product_name VARCHAR(200) NOT NULL                                â”‚
  â”‚  category VARCHAR(100) NOT NULL                                    â”‚
  â”‚  subcategory VARCHAR(100)                                          â”‚
  â”‚  description TEXT                                                  â”‚
  â”‚  sku VARCHAR(100) UNIQUE NOT NULL                                  â”‚
  â”‚  brand VARCHAR(100)                                                â”‚
  â”‚  price DECIMAL(10,2) NOT NULL CHECK (price > 0)                    â”‚
  â”‚  compare_at_price DECIMAL(10,2)                                    â”‚
  â”‚  stock_quantity INTEGER NOT NULL CHECK (stock_quantity >= 0)       â”‚
  â”‚  unit VARCHAR(20) DEFAULT 'piece'                                  â”‚
  â”‚  weight_kg DECIMAL(10,3)                                           â”‚
  â”‚  dimensions_cm VARCHAR(50)                                         â”‚
  â”‚  image_url TEXT                                                    â”‚
  â”‚  upload_id VARCHAR(50)                                             â”‚
  â”‚  status VARCHAR(20) DEFAULT 'active'                               â”‚
  â”‚  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP                    â”‚
  â”‚  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP                    â”‚
  â”‚                                                                     â”‚
  â”‚  UNIQUE (vendor_id, vendor_product_id)                             â”‚
  â”‚                                                                     â”‚
  â”‚  Indexes:                                                           â”‚
  â”‚  â€¢ idx_vendor_id ON (vendor_id)                                    â”‚
  â”‚  â€¢ idx_category ON (category)                                      â”‚
  â”‚  â€¢ idx_upload_id ON (upload_id)                                    â”‚
  â”‚  â€¢ idx_sku ON (sku) [UNIQUE]                                       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  TABLE: product_categories                                         â”‚
  â”‚  Purpose: Category whitelist for validation                        â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  category_id SERIAL PRIMARY KEY                                    â”‚
  â”‚  category_name VARCHAR(100) UNIQUE NOT NULL                        â”‚
  â”‚  description TEXT                                                  â”‚
  â”‚  is_active BOOLEAN DEFAULT TRUE                                    â”‚
  â”‚  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP                    â”‚
  â”‚                                                                     â”‚
  â”‚  Sample Data:                                                       â”‚
  â”‚  1 | Electronics         | Electronic devices... | true            â”‚
  â”‚  2 | Computer Accessories| Peripherals...        | true            â”‚
  â”‚  3 | Clothing           | Apparel items...      | true            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  TABLE: upload_history                                             â”‚
  â”‚  Purpose: Audit trail of all CSV uploads                           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  upload_id VARCHAR(50) PRIMARY KEY                                 â”‚
  â”‚  vendor_id VARCHAR(50) REFERENCES vendors(vendor_id)               â”‚
  â”‚  file_name VARCHAR(255) NOT NULL                                   â”‚
  â”‚  file_size_bytes BIGINT                                            â”‚
  â”‚  total_records INTEGER                                             â”‚
  â”‚  valid_records INTEGER DEFAULT 0                                   â”‚
  â”‚  error_records INTEGER DEFAULT 0                                   â”‚
  â”‚  status VARCHAR(20)                                                â”‚
  â”‚    ['processing', 'completed', 'partial', 'failed']                â”‚
  â”‚  error_file_s3_key VARCHAR(500)                                    â”‚
  â”‚  upload_timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP              â”‚
  â”‚  processing_started_at TIMESTAMP                                   â”‚
  â”‚  processing_completed_at TIMESTAMP                                 â”‚
  â”‚                                                                     â”‚
  â”‚  Indexes:                                                           â”‚
  â”‚  â€¢ idx_vendor_upload ON (vendor_id, upload_timestamp DESC)         â”‚
  â”‚  â€¢ idx_status ON (status)                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  TABLE: validation_errors                                          â”‚
  â”‚  Purpose: Detailed error tracking                                  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  error_id SERIAL PRIMARY KEY                                       â”‚
  â”‚  upload_id VARCHAR(50) REFERENCES upload_history(upload_id)        â”‚
  â”‚  vendor_id VARCHAR(50) REFERENCES vendors(vendor_id)               â”‚
  â”‚  row_number INTEGER NOT NULL                                       â”‚
  â”‚  vendor_product_id VARCHAR(100)                                    â”‚
  â”‚  error_type VARCHAR(50) NOT NULL                                   â”‚
  â”‚    ['MISSING_REQUIRED_FIELDS', 'INVALID_PRICE',                    â”‚
  â”‚     'INVALID_STOCK_QUANTITY', 'FIELD_LENGTH_EXCEEDED',             â”‚
  â”‚     'INVALID_CATEGORY', 'DUPLICATE_SKU',                           â”‚
  â”‚     'DUPLICATE_VENDOR_PRODUCT_ID']                                 â”‚
  â”‚  error_field VARCHAR(100)                                          â”‚
  â”‚  error_message TEXT NOT NULL                                       â”‚
  â”‚  original_data JSONB                                               â”‚
  â”‚  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP                    â”‚
  â”‚                                                                     â”‚
  â”‚  Indexes:                                                           â”‚
  â”‚  â€¢ idx_upload_errors ON (upload_id)                                â”‚
  â”‚  â€¢ idx_error_type ON (error_type)                                  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DYNAMODB - TEMPORARY STAGING                                                 â”‚
â”‚  UploadRecords table                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  TABLE: UploadRecords                                              â”‚
  â”‚  Purpose: Temporary staging during validation                      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  Partition Key: upload_id (String)                                 â”‚
  â”‚  Sort Key: record_id (String)                                      â”‚
  â”‚                                                                     â”‚
  â”‚  Attributes:                                                        â”‚
  â”‚  â€¢ vendor_id (String)                                              â”‚
  â”‚  â€¢ row_number (Number)                                             â”‚
  â”‚  â€¢ status (String)                                                 â”‚
  â”‚    ['pending_validation', 'validated', 'error']                    â”‚
  â”‚  â€¢ product_data (Map)                                              â”‚
  â”‚    {                                                                â”‚
  â”‚      vendor_product_id: String,                                    â”‚
  â”‚      product_name: String,                                         â”‚
  â”‚      category: String,                                             â”‚
  â”‚      sku: String,                                                  â”‚
  â”‚      price: Number,                                                â”‚
  â”‚      stock_quantity: Number,                                       â”‚
  â”‚      ...                                                            â”‚
  â”‚    }                                                                â”‚
  â”‚  â€¢ error_reason (String) [if status='error']                       â”‚
  â”‚  â€¢ error_details (String) [if status='error']                      â”‚
  â”‚  â€¢ created_at (String) [ISO 8601]                                  â”‚
  â”‚  â€¢ processed_at (String) [ISO 8601]                                â”‚
  â”‚                                                                     â”‚
  â”‚  Global Secondary Index: VendorIndex                               â”‚
  â”‚  â€¢ Partition Key: vendor_id                                        â”‚
  â”‚  â€¢ ProjectionType: ALL                                             â”‚
  â”‚                                                                     â”‚
  â”‚  DynamoDB Streams: ENABLED                                         â”‚
  â”‚  â€¢ StreamViewType: NEW_IMAGE                                       â”‚
  â”‚  â€¢ Retention: 24 hours                                             â”‚
  â”‚                                                                     â”‚
  â”‚  Sample Item:                                                       â”‚
  â”‚  {                                                                  â”‚
  â”‚    "upload_id": "UPLOAD_20241221_103045",                         â”‚
  â”‚    "record_id": "REC_00001",                                       â”‚
  â”‚    "vendor_id": "VEND001",                                         â”‚
  â”‚    "row_number": 1,                                                â”‚
  â”‚    "status": "validated",                                          â”‚
  â”‚    "product_data": {                                               â”‚
  â”‚      "vendor_product_id": "PROD0001",                              â”‚
  â”‚      "product_name": "Wireless Mouse",                             â”‚
  â”‚      "sku": "SKU-001",                                             â”‚
  â”‚      "price": 19.99,                                               â”‚
  â”‚      "stock_quantity": 150                                         â”‚
  â”‚    },                                                               â”‚
  â”‚    "created_at": "2024-12-21T10:30:45.123Z",                      â”‚
  â”‚    "processed_at": "2024-12-21T10:30:50.456Z"                     â”‚
  â”‚  }                                                                  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

DATA RELATIONSHIPS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

vendors (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ (N) products
   â”‚                          â”‚
   â”‚                          â”‚
   â””â”€â”€â”€â”€ (N) upload_history   â”‚
             â”‚                â”‚
             â”‚                â”‚
             â””â”€ (N) validation_errors
```

---

## 7. Error Handling Architecture

### Multi-Layer Error Strategy
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ERROR HANDLING ARCHITECTURE                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LAYER 1: PREVENTION (Validation Rules)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  VALIDATOR LAMBDA                   â”‚
                    â”‚                                     â”‚
                    â”‚  7 Validation Rules:                â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
                    â”‚  â”‚ 1. Required Fields              â”‚â”‚
                    â”‚  â”‚ 2. Price Range (0.01-999999.99) â”‚â”‚
                    â”‚  â”‚ 3. Stock Range (0-1000000)      â”‚â”‚
                    â”‚  â”‚ 4. Field Lengths                â”‚â”‚
                    â”‚  â”‚ 5. Category Whitelist           â”‚â”‚
                    â”‚  â”‚ 6. SKU Uniqueness               â”‚â”‚
                    â”‚  â”‚ 7. Vendor Product ID Uniqueness â”‚â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
                    â”‚                                     â”‚
                    â”‚  Each rule prevents bad data        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LAYER 2: DETECTION (Try-Catch Blocks)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  ALL LAMBDA FUNCTIONS               â”‚
                    â”‚                                     â”‚
                    â”‚  try:                               â”‚
                    â”‚      # Risky operation              â”‚
                    â”‚      conn = psycopg2.connect(...)   â”‚
                    â”‚  except Exception as e:             â”‚
                    â”‚      logger.error(f"Error: {e}")    â”‚
                    â”‚      # Handle gracefully            â”‚
                    â”‚                                     â”‚
                    â”‚  Common exceptions:                 â”‚
                    â”‚  â€¢ psycopg2.OperationalError        â”‚
                    â”‚  â€¢ botocore.exceptions.ClientError  â”‚
                    â”‚  â€¢ KeyError, ValueError             â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LAYER 3: RECOVERY (Retry Logic)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  LAMBDA AUTOMATIC RETRIES           â”‚
                    â”‚                                     â”‚
                    â”‚  Event Source Mappings:             â”‚
                    â”‚  â€¢ DynamoDB Streams: 10000 retries  â”‚
                    â”‚  â€¢ SQS: 3 retries                   â”‚
                    â”‚                                     â”‚
                    â”‚  Failed after retries?              â”‚
                    â”‚  â†“                                  â”‚
                    â”‚  DLQ (Dead-Letter Queue)            â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  DEAD-LETTER QUEUE                  â”‚
                    â”‚  product-validation-errors-dlq      â”‚
                    â”‚                                     â”‚
                    â”‚  Messages that failed all retries   â”‚
                    â”‚  â€¢ Manual review required           â”‚
                    â”‚  â€¢ CloudWatch Alarm triggered       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LAYER 4: NOTIFICATION (Logging & Alerts)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  CLOUDWATCH LOGS                    â”‚
                    â”‚                                     â”‚
                    â”‚  Every Lambda execution logged:     â”‚
                    â”‚  â€¢ INFO: Normal operations          â”‚
                    â”‚  â€¢ WARN: Recoverable issues         â”‚
                    â”‚  â€¢ ERROR: Failures                  â”‚
                    â”‚                                     â”‚
                    â”‚  /aws/lambda/csv-parser             â”‚
                    â”‚  /aws/lambda/product-validator      â”‚
                    â”‚  /aws/lambda/error-processor        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  CLOUDWATCH METRICS                 â”‚
                    â”‚                                     â”‚
                    â”‚  Custom Metrics:                    â”‚
                    â”‚  â€¢ ProductsValidated                â”‚
                    â”‚  â€¢ ProductsRejected                 â”‚
                    â”‚  â€¢ ValidationProcessingTime         â”‚
                    â”‚  â€¢ ErrorsProcessed                  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  CLOUDWATCH ALARMS                  â”‚
                    â”‚                                     â”‚
                    â”‚  Triggers on:                       â”‚
                    â”‚  â€¢ Error rate > 10%                 â”‚
                    â”‚  â€¢ Processing time > 5 min          â”‚
                    â”‚  â€¢ DLQ messages > 0                 â”‚
                    â”‚                                     â”‚
                    â”‚  Action: SNS notification to Ops    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LAYER 5: AUDIT (Database Recording)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  RDS: validation_errors TABLE       â”‚
                    â”‚                                     â”‚
                    â”‚  Every error recorded:              â”‚
                    â”‚  â€¢ upload_id                        â”‚
                    â”‚  â€¢ row_number                       â”‚
                    â”‚  â€¢ error_type                       â”‚
                    â”‚  â€¢ error_message                    â”‚
                    â”‚  â€¢ original_data (JSONB)            â”‚
                    â”‚  â€¢ timestamp                        â”‚
                    â”‚                                     â”‚
                    â”‚  Queryable for:                     â”‚
                    â”‚  â€¢ Trend analysis                   â”‚
                    â”‚  â€¢ Vendor reports                   â”‚
                    â”‚  â€¢ Compliance audits                â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ERROR FLOW EXAMPLE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Product with Duplicate SKU:
    â†“
Layer 1: Validator detects duplicate
    â”œâ”€ Query: SELECT * FROM products WHERE sku='SKU-001'
    â””â”€ Result: 1 row found â†’ DUPLICATE!
    â†“
Layer 2: Error caught and handled
    â”œâ”€ No exception thrown (controlled)
    â””â”€ Create error record
    â†“
Layer 3: No retry needed (expected error)
    â†“
Layer 4: Log error + Send metric
    â”œâ”€ CloudWatch Log: "Duplicate SKU detected: SKU-001"
    â””â”€ Metric: ProductsRejected +1
    â†“
Layer 5: Record in database
    â”œâ”€ INSERT INTO validation_errors
    â”œâ”€ UPDATE DynamoDB status='error'
    â””â”€ SEND to SQS error queue
    â†“
Vendor receives error CSV with details âœ“
```

---

## 8. Security Architecture

### Defense in Depth
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          SECURITY ARCHITECTURE                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LAYER 1: NETWORK SECURITY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  VPC ISOLATION                      â”‚
                    â”‚                                     â”‚
                    â”‚  â€¢ Private subnets for RDS          â”‚
                    â”‚  â€¢ Lambda in VPC (access to RDS)    â”‚
                    â”‚  â€¢ No public internet access        â”‚
                    â”‚  â€¢ NAT Gateway for AWS APIs only    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  SECURITY GROUPS                    â”‚
                    â”‚                                     â”‚
                    â”‚  lambda-sg:                         â”‚
                    â”‚  â€¢ Outbound: 5432 â†’ rds-sg only     â”‚
                    â”‚  â€¢ Outbound: 443 â†’ AWS APIs         â”‚
                    â”‚  â€¢ Inbound: NONE                    â”‚
                    â”‚                                     â”‚
                    â”‚  rds-sg:                            â”‚
                    â”‚  â€¢ Inbound: 5432 from lambda-sg     â”‚
                    â”‚  â€¢ Inbound: Deny all else           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LAYER 2: IDENTITY & ACCESS (IAM)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  IAM ROLES (Least Privilege)        â”‚
                    â”‚                                     â”‚
                    â”‚  csv-parser-role:                   â”‚
                    â”‚  â€¢ s3:GetObject (uploads/* only)    â”‚
                    â”‚  â€¢ dynamodb:BatchWriteItem          â”‚
                    â”‚  â€¢ rds:* (specific DB only)         â”‚
                    â”‚  â€¢ secretsmanager:GetSecretValue    â”‚
                    â”‚  â€¢ logs:*                           â”‚
                    â”‚                                     â”‚
                    â”‚  product-validator-role:            â”‚
                    â”‚  â€¢ dynamodb:GetRecords (streams)    â”‚
                    â”‚  â€¢ dynamodb:UpdateItem              â”‚
                    â”‚  â€¢ rds:*                            â”‚
                    â”‚  â€¢ sqs:SendMessage                  â”‚
                    â”‚  â€¢ secretsmanager:GetSecretValue    â”‚
                    â”‚  â€¢ logs:*                           â”‚
                    â”‚                                     â”‚
                    â”‚  error-processor-role:              â”‚
                    â”‚  â€¢ sqs:ReceiveMessage               â”‚
                    â”‚  â€¢ sqs:DeleteMessage                â”‚
                    â”‚  â€¢ s3:PutObject (errors/* only)     â”‚
                    â”‚  â€¢ sns:Publish                      â”‚
                    â”‚  â€¢ rds:*                            â”‚
                    â”‚  â€¢ secretsmanager:GetSecretValue    â”‚
                    â”‚  â€¢ logs:*                           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LAYER 3: DATA PROTECTION (Encryption)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  ENCRYPTION AT REST                 â”‚
                    â”‚                                     â”‚
                    â”‚  S3:                                â”‚
                    â”‚  â€¢ AES-256 server-side encryption   â”‚
                    â”‚  â€¢ Bucket-level encryption          â”‚
                    â”‚                                     â”‚
                    â”‚  RDS:                               â”‚
                    â”‚  â€¢ Encrypted storage volumes        â”‚
                    â”‚  â€¢ Automated backups encrypted      â”‚
                    â”‚                                     â”‚
                    â”‚  DynamoDB:                          â”‚
                    â”‚  â€¢ Encryption enabled (default)     â”‚
                    â”‚                                     â”‚
                    â”‚  Secrets Manager:                   â”‚
                    â”‚  â€¢ KMS encryption (CMK)             â”‚
                    â”‚  â€¢ Encrypted in transit and at rest â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  ENCRYPTION IN TRANSIT              â”‚
                    â”‚                                     â”‚
                    â”‚  â€¢ All AWS API calls: HTTPS (TLS)   â”‚
                    â”‚  â€¢ Lambda â†’ RDS: TLS supported      â”‚
                    â”‚  â€¢ S3 uploads: HTTPS required       â”‚
                    â”‚  â€¢ SNS emails: TLS                  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LAYER 4: SECRET MANAGEMENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  SECRETS MANAGER                    â”‚
                    â”‚                                     â”‚
                    â”‚  ecommerce/rds/credentials          â”‚
                    â”‚  {                                  â”‚
                    â”‚    "username": "postgres",          â”‚
                    â”‚    "password": "***",               â”‚
                    â”‚    "host": "ecommerce-db.xxx",      â”‚
                    â”‚    "port": 5432,                    â”‚
                    â”‚    "dbname": "ecommerce_platform"   â”‚
                    â”‚  }                                  â”‚
                    â”‚                                     â”‚
                    â”‚  Features:                          â”‚
                    â”‚  â€¢ KMS encryption                   â”‚
                    â”‚  â€¢ Automatic rotation               â”‚
                    â”‚  â€¢ Versioning                       â”‚
                    â”‚  â€¢ Audit trail (CloudTrail)         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  LAMBDA CACHING                     â”‚
                    â”‚                                     â”‚
                    â”‚  Client-side cache:                 â”‚
                    â”‚  â€¢ TTL: 1 hour                      â”‚
                    â”‚  â€¢ Reused across invocations        â”‚
                    â”‚  â€¢ Reduces API calls (cost + perf)  â”‚
                    â”‚                                     â”‚
                    â”‚  Cache miss: ~50ms (API call)       â”‚
                    â”‚  Cache hit: <1ms (in-memory)        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LAYER 5: AUDIT & COMPLIANCE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  CLOUDWATCH LOGS                    â”‚
                    â”‚                                     â”‚
                    â”‚  Every operation logged:            â”‚
                    â”‚  â€¢ Lambda executions                â”‚
                    â”‚  â€¢ API calls (via CloudTrail)       â”‚
                    â”‚  â€¢ Database queries                 â”‚
                    â”‚  â€¢ Error events                     â”‚
                    â”‚                                     â”‚
                    â”‚  Retention: 30 days (configurable)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  RDS AUDIT TRAIL                    â”‚
                    â”‚                                     â”‚
                    â”‚  upload_history table:              â”‚
                    â”‚  â€¢ Every upload tracked             â”‚
                    â”‚  â€¢ Timestamps recorded              â”‚
                    â”‚  â€¢ Results logged                   â”‚
                    â”‚                                     â”‚
                    â”‚  validation_errors table:           â”‚
                    â”‚  â€¢ Every error logged               â”‚
                    â”‚  â€¢ Original data preserved (JSONB)  â”‚
                    â”‚  â€¢ Queryable for compliance         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  AWS CLOUDTRAIL                     â”‚
                    â”‚                                     â”‚
                    â”‚  Tracks:                            â”‚
                    â”‚  â€¢ IAM role assumptions             â”‚
                    â”‚  â€¢ AWS API calls                    â”‚
                    â”‚  â€¢ Resource modifications           â”‚
                    â”‚  â€¢ Who did what when                â”‚
                    â”‚                                     â”‚
                    â”‚  Retention: 90 days                 â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SECURITY CHECKLIST:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ“ No hardcoded credentials
âœ“ Secrets in Secrets Manager
âœ“ Least privilege IAM roles
âœ“ RDS not publicly accessible
âœ“ Lambda in VPC
âœ“ Security groups properly configured
âœ“ All data encrypted at rest
âœ“ All traffic encrypted in transit
âœ“ Complete audit trail
âœ“ CloudWatch monitoring enabled
âœ“ Automatic backups configured
âœ“ Multi-AZ deployment (RDS)
âœ“ Presigned URLs time-limited (7 days)
```

---

## Summary

This architecture diagram document provides:

1. âœ… **High-Level Architecture** - Bird's eye view
2. âœ… **Detailed Components** - Every AWS service shown
3. âœ… **Data Flow** - Complete journey from upload to email
4. âœ… **Network Architecture** - VPC, subnets, security groups
5. âœ… **Event-Driven Flow** - Timeline with exact timing
6. âœ… **Database Architecture** - Schema with relationships
7. âœ… **Error Handling** - Multi-layer strategy
8. âœ… **Security Architecture** - Defense in depth

**Perfect for:**
- ğŸ“š Student learning
- ğŸ‘¨â€ğŸ« Teaching presentations
- ğŸ“Š Documentation
- ğŸ” System understanding
- ğŸ› Troubleshooting
- ğŸ’¼ Portfolio demonstrations

**Use these diagrams to:**
- Explain system design decisions
- Understand data flow
- Troubleshoot issues
- Plan extensions
- Present to stakeholders
